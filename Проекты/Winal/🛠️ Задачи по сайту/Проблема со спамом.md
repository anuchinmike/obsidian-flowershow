---
title: –ü—Ä–æ–±–ª–µ–º–∞ —Å–æ —Å–ø–∞–º–æ–º
created: 2025-01-27
modified: 2025-01-27
status: completed
tags:
  - winal
  - winal-–∑–∞–¥–∞—á–∏-—Å–∞–π—Ç
  - winal-–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
  - winal-—Å–ø–∞–º
aliases:
---
# üö® –ê–ù–ê–õ–ò–ó –£–Ø–ó–í–ò–ú–û–°–¢–ï–ô –°–ü–ê–ú–ê –í –ò–ù–¢–ï–ì–†–ê–¶–ò–ò BITRIX24

## üîç **–û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏:**

### 1. **–û–¢–°–£–¢–°–¢–í–ò–ï AJAX –û–ë–†–ê–ë–û–¢–ß–ò–ö–ê –í WORDPRESS** ‚ùå

```
// –í footer.php –µ—Å—Ç—å JavaScript —Ñ—É–Ω–∫—Ü–∏—è sendBx24Form
$.ajax({
    url: '',  // ‚Üê –ü–£–°–¢–û–ô URL!
    data: data,
    processData: false,
    contentType: false,
    type: 'POST',
    // ...
});
```

**–ü—Ä–æ–±–ª–µ–º–∞**: AJAX –∑–∞–ø—Ä–æ—Å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –Ω–∞ –ø—É—Å—Ç–æ–π URL (`url: ''`), —á—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –æ–Ω –∏–¥–µ—Ç –Ω–∞ —Ç–µ–∫—É—â—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É, –ù–û –≤ WordPress –Ω–µ—Ç –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ AJAX –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞!

### 2. **–ü–†–Ø–ú–û–ô –î–û–°–¢–£–ü –ö order.php** üîì

```
// –í functions.php:
include 'Bx24/order.php';  // ‚Üê –§–∞–π–ª –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –í–°–ï–ì–î–ê
```

**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è —É—è–∑–≤–∏–º–æ—Å—Ç—å**: –§–∞–π–ª `order.php` –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–π –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∏ –º–æ–∂–µ—Ç –±—ã—Ç—å –≤—ã–∑–≤–∞–Ω –Ω–∞–ø—Ä—è–º—É—é —á–µ—Ä–µ–∑ POST –∑–∞–ø—Ä–æ—Å!

### 3. **–û–¢–°–£–¢–°–¢–í–ò–ï –í–ê–õ–ò–î–ê–¶–ò–ò –ò –ó–ê–©–ò–¢–´** ‚ö†Ô∏è

–í `order.php` –Ω–∞–π–¥–µ–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ –ø—Ä–æ–±–ª–µ–º—ã:

```
$formId = (int)$_POST['gform_submit'];  // ‚Üê –¢–æ–ª—å–∫–æ –±–∞–∑–æ–≤–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

\
if (!$formId) {
    return false;  // ‚Üê –°–ª–∞–±–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è
}

\
// –ü—Ä—è–º–æ–µ –æ–±—Ä–∞—â–µ–Ω–∏–µ –∫ $_POST –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–æ–∫:
$phone = $_POST['input_4'];
$name = $_POST['input_1'];
$email = $_POST['input_5'];
$comments = $_POST['input_3'];
```

**–ü—Ä–æ–±–ª–µ–º—ã**:

- ‚ùå –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ nonce
    
- ‚ùå –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ referer
    
- ‚ùå –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ CAPTCHA
    
- ‚ùå –ù–µ—Ç rate limiting
    
- ‚ùå –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å email/phone
    

### 4. **HARDCODED API –ö–õ–Æ–ß–ò –í –û–¢–ö–†–´–¢–û–ú –ö–û–î–ï** üîê

```
// –í Bx24.php:
const createContactUrl = 'https://winal.bitrix24.ru/rest/1315/taznscd5a2elwvf0/crm.contact.add.json';
const createDealUrl = 'https://winal.bitrix24.ru/rest/1315/2e3ijvy60hnv8hy3/crm.deal.add.json';
const getContactLists = 'https://winal.bitrix24.ru/rest/1315/l2w0qz9blflcllhd/crm.contact.list.json';
```

**–£—è–∑–≤–∏–º–æ—Å—Ç—å**: API –∫–ª—é—á–∏ Bitrix24 —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ –≤ –∫–æ–¥–µ!

### 5. **–ê–ù–ê–õ–ò–ó –°–ü–ê–ú-–ó–ê–Ø–í–ö–ò** üïµÔ∏è

–ò–∑ –ª–æ–≥–∞ `createDeal-request.php` –≤–∏–¥–Ω–∞ —Ç–∏–ø–∏—á–Ω–∞—è —Å–ø–∞–º-–∑–∞—è–≤–∫–∞:

```
[COMMENTS] => –ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! 
–ü–æ–º–æ–∂–µ–º —É–∑–Ω–∞—Ç—å –æ –í–∞—à–µ–º –ø—Ä–æ–¥—É–∫—Ç–µ/—É—Å–ª—É–≥–µ –≤–ª–∞–¥–µ–ª—å—Ü–∞–º 800 000 —Å–∞–π—Ç–æ–≤! 
...
–ù–∞—à E-mail: rassylkimaksim@gmail.com
```

## üéØ **–ö–ê–ö –ü–†–û–ò–°–•–û–î–ò–¢ –°–ü–ê–ú:**

1. **–°–ø–∞–º–µ—Ä—ã –æ–±–Ω–∞—Ä—É–∂–∏–ª–∏**, —á—Ç–æ –º–æ–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å POST –∑–∞–ø—Ä–æ—Å—ã –Ω–∞–ø—Ä—è–º—É—é –Ω–∞ –ª—é–±—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É —Å–∞–π—Ç–∞
    
2. **–î–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è** –≤ `order.php` –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–æ–∫
    
3. **–ó–∞—è–≤–∫–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è** –≤ Bitrix24, –Ω–æ –ù–ï –≤ Gravity Forms (–ø–æ—ç—Ç–æ–º—É –≤ –∞–¥–º–∏–Ω–∫–µ WordPress –∏—Ö –Ω–µ—Ç)
    
4. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∑–∞—â–∏—Ç—ã** –ø–æ–∑–≤–æ–ª—è–µ—Ç –º–∞—Å—Å–æ–≤—ã–µ –∞—Ç–∞–∫–∏
    

## üõ°Ô∏è **–ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø:**

### 1. **–°–æ–∑–¥–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π AJAX –æ–±—Ä–∞–±–æ—Ç—á–∏–∫**

```
// –î–æ–±–∞–≤–∏—Ç—å –≤ functions.php:
add_action('wp_ajax_sendBx24Form', 'handle_bx24_form');
add_action('wp_ajax_nopriv_sendBx24Form', 'handle_bx24_form');

\
function handle_bx24_form() {
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ nonce
    if (!wp_verify_nonce($_POST['nonce'], 'bx24_form_nonce')) {
        wp_die('Security check failed');
    }
    
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ referer
    if (!wp_get_referer()) {
        wp_die('Invalid request');
    }
    
    // Rate limiting
    // CAPTCHA –ø—Ä–æ–≤–µ—Ä–∫–∞
    // –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
    
    include 'Bx24/order.php';
    wp_die();
}
```

### 2. **–ó–∞—â–∏—Ç–∏—Ç—å order.php**

```
// –í –Ω–∞—á–∞–ª–æ order.php –¥–æ–±–∞–≤–∏—Ç—å:
if (!defined('DOING_AJAX') || !DOING_AJAX) {
    wp_die('Direct access not allowed');
}

\
if (!wp_verify_nonce($_POST['nonce'], 'bx24_form_nonce')) {
    wp_die('Security check failed');
}
```

### 3. **–î–æ–±–∞–≤–∏—Ç—å CAPTCHA**

```
// –í footer.php –∏–∑–º–µ–Ω–∏—Ç—å AJAX:
$.ajax({
    url: '<?php echo admin_url('admin-ajax.php'); ?>',
    data: data,
    // ...
});
```

### 4. **–°–∫—Ä—ã—Ç—å API –∫–ª—é—á–∏**

```
// –í wp-config.php:
define('BITRIX24_CONTACT_KEY', 'taznscd5a2elwvf0');
define('BITRIX24_DEAL_KEY', '2e3ijvy60hnv8hy3');
define('BITRIX24_LIST_KEY', 'l2w0qz9blflcllhd');
```

## üö® **–ù–ï–ú–ï–î–õ–ï–ù–ù–´–ï –î–ï–ô–°–¢–í–ò–Ø:**

1. **–°—Ä–æ—á–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫–∏** –≤ `order.php`
    
2. **–ò–∑–º–µ–Ω–∏—Ç—å URL AJAX** –∑–∞–ø—Ä–æ—Å–∞
    
3. **–î–æ–±–∞–≤–∏—Ç—å CAPTCHA** –Ω–∞ –≤—Å–µ —Ñ–æ—Ä–º—ã
    
4. **–ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ API –∫–ª—é—á–∏** –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Å—Ä–µ–¥—ã
    
5. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
    

## üìä **–û–¶–ï–ù–ö–ê –ö–†–ò–¢–ò–ß–ù–û–°–¢–ò: 9/10**

–°–∏—Å—Ç–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ—Ç–∫—Ä—ã—Ç–∞ –¥–ª—è —Å–ø–∞–º-–∞—Ç–∞–∫ –∏–∑-–∑–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è –±–∞–∑–æ–≤–æ–π –∑–∞—â–∏—Ç—ã WordPress AJAX –∏ –ø—Ä—è–º–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫—É —Ñ–æ—Ä–º.